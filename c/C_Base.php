<?php    include_once('m/M_Cart.php');    /**     * Class C_Base     * Базовый контроллер сайта     */    abstract class C_Base extends C_Controller    {        protected $title;          // заголовок страницы        protected $subtitle;        protected $content;        // содержание страницы        protected $username;       // имя авторизовавшегося пользователя        protected $notification;        protected $userID;        public function __construct()        {            if (isset($_SESSION['user_id'])) {                $this->userID = $_SESSION['user_id'];            } else {                $this->userID = false;            }        }        protected function before()        {            $this->title = '';            $this->content = '';            $this->username = '';            $this->notification = '';        }        /**         * Генерация базового шаблона         */        public function twig_render()        {            try {                $loader = new \Twig\Loader\FilesystemLoader(VIEW_DIR);                $twig = new \Twig\Environment($loader);                // добавим глобальные переменные —                // теперь $_SESSION['username'] в PHP-файлу будет эквивалентно {{ session.username }} в twig-файле                $twig->addGlobal('session', $_SESSION);            } catch (Exception $e) {                die('Error: ' . $e->getMessage());            }            $basket_object = new M_Cart();            $totalCount = $basket_object->getTotalCount($this->userID);            try {                $vars = array('title'        => $this->title,                              'subtitle'     => $this->subtitle,                              'content'      => $this->content,                              'username'     => $this->username,                              'notification' => $this->notification,                              'uID'          => $this->userID,                              'totalCount'   => $totalCount);                $template = $twig->render('v_main.twig', $vars);                echo $template;            } catch (Exception $e) {                die('Error: ' . $e->getMessage());            }        }        // редирект на эту же страницу        public function redirectSelf()        {            header("Location: http://" .                $_SERVER['SERVER_NAME'] .                $_SERVER['PHP_SELF'] . '?' .                $_SERVER['QUERY_STRING']);            exit();        }    }